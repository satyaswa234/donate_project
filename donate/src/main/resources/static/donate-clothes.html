<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Donate Clothes - DonateHub</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f5f7fa; font-family: 'Inter', sans-serif; }
        h1 { color: #0d6efd; margin: 20px 0; }
        table { background: #fff; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        th { background: #0d6efd; color: #fff; }
        .form-container { background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); margin-bottom: 30px; }
    </style>
</head>
<body>
<div class="container">
    <h1 class="text-center">Donate Clothes</h1>

    <!-- Donation Form -->
    <div class="form-container">
        <h4>Enter Donation Details</h4>
        <form id="donateForm">
            <div class="mb-3">
                <label class="form-label">Item Name</label>
                <input type="text" class="form-control" id="itemName" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Quantity</label>
                <input type="number" class="form-control" id="quantity" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Condition</label>
                <input type="text" class="form-control" id="itemCondition" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Pickup Address</label>
                <input type="text" class="form-control" id="pickupAddress" required>
            </div>
            <div class="mb-3">
                <label class="form-label">User ID</label>
                <input type="number" class="form-control" id="userId" required>
            </div>
            <button type="submit" class="btn btn-primary">Submit Donation</button>
        </form>
    </div>

    <!-- Donations Table -->
    <div class="table-responsive">
        <table class="table table-bordered table-hover text-center" id="clothesTable">
            <thead>
            <tr>
                <th>ID</th>
                <th>Item Name</th>
                <th>Quantity</th>
                <th>Condition</th>
                <th>Pickup Address</th>
                <th>User ID</th>
            </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<script>
    async function fetchClothes() {
        const response = await fetch('http://localhost:8080/api/clothes/all');
        const clothes = await response.json();

        const tableBody = document.querySelector('#clothesTable tbody');
        tableBody.innerHTML = '';

        clothes.forEach(item => {
            const row = `
                <tr>
                    <td>${item.id}</td>
                    <td>${item.itemName}</td>
                    <td>${item.quantity}</td>
                    <td>${item.itemCondition}</td>
                    <td>${item.pickupAddress}</td>
                    <td>${item.userId}</td>
                </tr>
            `;
            tableBody.innerHTML += row;
        });
    }

    // Load table on page load
    fetchClothes();

    // Handle form submission
    document.getElementById('donateForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const data = {
            itemName: document.getElementById('itemName').value,
            quantity: parseInt(document.getElementById('quantity').value),
            itemCondition: document.getElementById('itemCondition').value,
            pickupAddress: document.getElementById('pickupAddress').value,
            userId: parseInt(document.getElementById('userId').value)
        };

        const response = await fetch('http://localhost:8080/api/clothes', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });

        if(response.ok) {
            alert('Donation added successfully!');
            fetchClothes(); // Refresh table
            document.getElementById('donateForm').reset();
        } else {
            alert('Failed to add donation.');
        }
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
